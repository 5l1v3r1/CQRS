\hypertarget{classCqrs_1_1Cache_1_1CacheRepository}{}\doxysection{Cqrs.\+Cache.\+Cache\+Repository$<$ T\+Authentication\+Token $>$ Class Template Reference}
\label{classCqrs_1_1Cache_1_1CacheRepository}\index{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$@{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$}}


Uses Memory\+Cache.\+Default to provide a caching mechanism to improve performance of a I\+Aggregate\+Repository$<$\+T\+Authentication\+Token$>$.  


Inheritance diagram for Cqrs.\+Cache.\+Cache\+Repository$<$ T\+Authentication\+Token $>$\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classCqrs_1_1Cache_1_1CacheRepository}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classCqrs_1_1Cache_1_1CacheRepository_a6c567e999a85f5803a920ce4912833a9_a6c567e999a85f5803a920ce4912833a9}{Cache\+Repository}} (\mbox{\hyperlink{interfaceCqrs_1_1Domain_1_1IAggregateRepository}{I\+Aggregate\+Repository}}$<$ T\+Authentication\+Token $>$ repository, \mbox{\hyperlink{interfaceCqrs_1_1Events_1_1IEventStore}{I\+Event\+Store}}$<$ T\+Authentication\+Token $>$ event\+Store)
\begin{DoxyCompactList}\small\item\em Instantiates a new instance of \mbox{\hyperlink{classCqrs_1_1Cache_1_1CacheRepository_a6c567e999a85f5803a920ce4912833a9_a6c567e999a85f5803a920ce4912833a9}{Cache\+Repository$<$\+T\+Authentication\+Token$>$}}. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classCqrs_1_1Cache_1_1CacheRepository_a69df7ee1dc2e4cd38431ab987655eab3_a69df7ee1dc2e4cd38431ab987655eab3}{Save$<$ T\+Aggregate\+Root $>$}} (T\+Aggregate\+Root aggregate, int? expected\+Version=null)
\begin{DoxyCompactList}\small\item\em Locks the cache, adds the provided {\itshape aggregate}  to the cache if not already in it, then calls I\+Aggregate\+Repository$<$\+T\+Authentication\+Token$>$.\+Save$<$\+T\+Aggregate\+Root$>$ on Repository. In the event of an Exception the {\itshape aggregate}  is always ejected out of the \mbox{\hyperlink{namespaceCqrs_1_1Cache}{Cache}}. \end{DoxyCompactList}\item 
virtual T\+Aggregate\+Root \mbox{\hyperlink{classCqrs_1_1Cache_1_1CacheRepository_a037acba636aedf23ff376ac0b749ec0c_a037acba636aedf23ff376ac0b749ec0c}{Get$<$ T\+Aggregate\+Root $>$}} (Guid aggregate\+Id, I\+List$<$ \mbox{\hyperlink{interfaceCqrs_1_1Events_1_1IEvent}{I\+Event}}$<$ T\+Authentication\+Token $>$$>$ events=null)
\begin{DoxyCompactList}\small\item\em Locks the cache, checks if the aggregate is tracked in the \mbox{\hyperlink{namespaceCqrs_1_1Cache}{Cache}}, if it is retrieves the aggregate from the \mbox{\hyperlink{namespaceCqrs_1_1Cache}{Cache}} and then uses either the provided {\itshape events}  or makes a call I\+Event\+Store$<$\+T\+Authentication\+Token$>$.\+Get(\+System.\+Type,\+System.\+Guid,bool,int) on the \mbox{\hyperlink{namespaceCqrs_1_1EventStore}{Event\+Store}} and rehydrates the cached aggregate with any new events from it\textquotesingle{}s cached version. If the aggregate is not in the \mbox{\hyperlink{namespaceCqrs_1_1Cache}{Cache}} I\+Aggregate\+Repository$<$\+T\+Authentication\+Token$>$.\+Get$<$\+T\+Aggregate\+Root$>$ is called on the Repository. \end{DoxyCompactList}\item 
T\+Aggregate\+Root \mbox{\hyperlink{classCqrs_1_1Cache_1_1CacheRepository_af23acddeed34def6d7a5e8d8df00ecd8_af23acddeed34def6d7a5e8d8df00ecd8}{Get\+To\+Version$<$ T\+Aggregate\+Root $>$}} (Guid aggregate\+Id, int version, I\+List$<$ \mbox{\hyperlink{interfaceCqrs_1_1Events_1_1IEvent}{I\+Event}}$<$ T\+Authentication\+Token $>$$>$ events=null)
\begin{DoxyCompactList}\small\item\em Retrieves an I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$ of type {\itshape T\+Aggregate\+Root}  up to and including the provided {\itshape version} . \end{DoxyCompactList}\item 
T\+Aggregate\+Root \mbox{\hyperlink{classCqrs_1_1Cache_1_1CacheRepository_aef9be4db697afa9bd98e264888c389ea_aef9be4db697afa9bd98e264888c389ea}{Get\+To\+Date$<$ T\+Aggregate\+Root $>$}} (Guid aggregate\+Id, Date\+Time versioned\+Date, I\+List$<$ \mbox{\hyperlink{interfaceCqrs_1_1Events_1_1IEvent}{I\+Event}}$<$ T\+Authentication\+Token $>$$>$ events=null)
\begin{DoxyCompactList}\small\item\em Retrieves an I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$ of type {\itshape T\+Aggregate\+Root}  up to and including the provided {\itshape versioned\+Date} . \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Uses Memory\+Cache.\+Default to provide a caching mechanism to improve performance of a I\+Aggregate\+Repository$<$\+T\+Authentication\+Token$>$. 


\begin{DoxyTemplParams}{Template Parameters}
{\em T\+Authentication\+Token} & The Type of authentication token.\\
\hline
\end{DoxyTemplParams}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classCqrs_1_1Cache_1_1CacheRepository_a6c567e999a85f5803a920ce4912833a9_a6c567e999a85f5803a920ce4912833a9}\label{classCqrs_1_1Cache_1_1CacheRepository_a6c567e999a85f5803a920ce4912833a9_a6c567e999a85f5803a920ce4912833a9}} 
\index{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$@{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$}!CacheRepository@{CacheRepository}}
\index{CacheRepository@{CacheRepository}!Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$@{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$}}
\doxysubsubsection{\texorpdfstring{CacheRepository()}{CacheRepository()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classCqrs_1_1Cache_1_1CacheRepository}{Cqrs.\+Cache.\+Cache\+Repository}}$<$ T\+Authentication\+Token $>$.\mbox{\hyperlink{classCqrs_1_1Cache_1_1CacheRepository}{Cache\+Repository}} (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{interfaceCqrs_1_1Domain_1_1IAggregateRepository}{I\+Aggregate\+Repository}}$<$ T\+Authentication\+Token $>$}]{repository,  }\item[{\mbox{\hyperlink{interfaceCqrs_1_1Events_1_1IEventStore}{I\+Event\+Store}}$<$ T\+Authentication\+Token $>$}]{event\+Store }\end{DoxyParamCaption})}



Instantiates a new instance of \mbox{\hyperlink{classCqrs_1_1Cache_1_1CacheRepository_a6c567e999a85f5803a920ce4912833a9_a6c567e999a85f5803a920ce4912833a9}{Cache\+Repository$<$\+T\+Authentication\+Token$>$}}. 



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classCqrs_1_1Cache_1_1CacheRepository_a037acba636aedf23ff376ac0b749ec0c_a037acba636aedf23ff376ac0b749ec0c}\label{classCqrs_1_1Cache_1_1CacheRepository_a037acba636aedf23ff376ac0b749ec0c_a037acba636aedf23ff376ac0b749ec0c}} 
\index{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$@{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$}!Get$<$ TAggregateRoot $>$@{Get$<$ TAggregateRoot $>$}}
\index{Get$<$ TAggregateRoot $>$@{Get$<$ TAggregateRoot $>$}!Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$@{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$}}
\doxysubsubsection{\texorpdfstring{Get$<$ TAggregateRoot $>$()}{Get< TAggregateRoot >()}}
{\footnotesize\ttfamily virtual T\+Aggregate\+Root \mbox{\hyperlink{classCqrs_1_1Cache_1_1CacheRepository}{Cqrs.\+Cache.\+Cache\+Repository}}$<$ T\+Authentication\+Token $>$.Get$<$ T\+Aggregate\+Root $>$ (\begin{DoxyParamCaption}\item[{Guid}]{aggregate\+Id,  }\item[{I\+List$<$ \mbox{\hyperlink{interfaceCqrs_1_1Events_1_1IEvent}{I\+Event}}$<$ T\+Authentication\+Token $>$$>$}]{events = {\ttfamily null} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Locks the cache, checks if the aggregate is tracked in the \mbox{\hyperlink{namespaceCqrs_1_1Cache}{Cache}}, if it is retrieves the aggregate from the \mbox{\hyperlink{namespaceCqrs_1_1Cache}{Cache}} and then uses either the provided {\itshape events}  or makes a call I\+Event\+Store$<$\+T\+Authentication\+Token$>$.\+Get(\+System.\+Type,\+System.\+Guid,bool,int) on the \mbox{\hyperlink{namespaceCqrs_1_1EventStore}{Event\+Store}} and rehydrates the cached aggregate with any new events from it\textquotesingle{}s cached version. If the aggregate is not in the \mbox{\hyperlink{namespaceCqrs_1_1Cache}{Cache}} I\+Aggregate\+Repository$<$\+T\+Authentication\+Token$>$.\+Get$<$\+T\+Aggregate\+Root$>$ is called on the Repository. 


\begin{DoxyTemplParams}{Template Parameters}
{\em T\+Aggregate\+Root} & The Type of the I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$.\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em aggregate\+Id} & The ID of the I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$ to get.\\
\hline
{\em events} & A collection of I\+Event$<$\+T\+Authentication\+Token$>$ to replay on the retrieved I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$. If null, the I\+Event\+Store$<$\+T\+Authentication\+Token$>$ will be used to retrieve a list of I\+Event$<$\+T\+Authentication\+Token$>$ for you. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{interfaceCqrs_1_1Domain_1_1IAggregateRepository_a890633fddbd05bd3b9e9968a2de095bb_a890633fddbd05bd3b9e9968a2de095bb}{Cqrs.\+Domain.\+I\+Aggregate\+Repository$<$ T\+Authentication\+Token $>$}}.

\begin{Desc}
\item[Type Constraints]\begin{description}
\item[{\em T\+Aggregate\+Root} : {\em I\+Aggregate\+Root$<$T\+Authentication\+Token$>$}]\end{description}
\end{Desc}
\mbox{\Hypertarget{classCqrs_1_1Cache_1_1CacheRepository_aef9be4db697afa9bd98e264888c389ea_aef9be4db697afa9bd98e264888c389ea}\label{classCqrs_1_1Cache_1_1CacheRepository_aef9be4db697afa9bd98e264888c389ea_aef9be4db697afa9bd98e264888c389ea}} 
\index{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$@{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$}!GetToDate$<$ TAggregateRoot $>$@{GetToDate$<$ TAggregateRoot $>$}}
\index{GetToDate$<$ TAggregateRoot $>$@{GetToDate$<$ TAggregateRoot $>$}!Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$@{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$}}
\doxysubsubsection{\texorpdfstring{GetToDate$<$ TAggregateRoot $>$()}{GetToDate< TAggregateRoot >()}}
{\footnotesize\ttfamily T\+Aggregate\+Root \mbox{\hyperlink{classCqrs_1_1Cache_1_1CacheRepository}{Cqrs.\+Cache.\+Cache\+Repository}}$<$ T\+Authentication\+Token $>$.Get\+To\+Date$<$ T\+Aggregate\+Root $>$ (\begin{DoxyParamCaption}\item[{Guid}]{aggregate\+Id,  }\item[{Date\+Time}]{versioned\+Date,  }\item[{I\+List$<$ \mbox{\hyperlink{interfaceCqrs_1_1Events_1_1IEvent}{I\+Event}}$<$ T\+Authentication\+Token $>$$>$}]{events = {\ttfamily null} }\end{DoxyParamCaption})}



Retrieves an I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$ of type {\itshape T\+Aggregate\+Root}  up to and including the provided {\itshape versioned\+Date} . 


\begin{DoxyTemplParams}{Template Parameters}
{\em T\+Aggregate\+Root} & The Type of the I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$.\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em aggregate\+Id} & The identifier of the I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$ to retrieve.\\
\hline
{\em versioned\+Date} & Load events up-\/to and including from this Date\+Time\\
\hline
{\em events} & A collection of I\+Event$<$\+T\+Authentication\+Token$>$ to replay on the retrieved I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$. If null, the I\+Event\+Store$<$\+T\+Authentication\+Token$>$ will be used to retrieve a list of I\+Event$<$\+T\+Authentication\+Token$>$ for you. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{interfaceCqrs_1_1Domain_1_1IAggregateRepository_a32308a27ce03c5d406e16b17430dd040_a32308a27ce03c5d406e16b17430dd040}{Cqrs.\+Domain.\+I\+Aggregate\+Repository$<$ T\+Authentication\+Token $>$}}.

\begin{Desc}
\item[Type Constraints]\begin{description}
\item[{\em T\+Aggregate\+Root} : {\em I\+Aggregate\+Root$<$T\+Authentication\+Token$>$}]\end{description}
\end{Desc}
\mbox{\Hypertarget{classCqrs_1_1Cache_1_1CacheRepository_af23acddeed34def6d7a5e8d8df00ecd8_af23acddeed34def6d7a5e8d8df00ecd8}\label{classCqrs_1_1Cache_1_1CacheRepository_af23acddeed34def6d7a5e8d8df00ecd8_af23acddeed34def6d7a5e8d8df00ecd8}} 
\index{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$@{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$}!GetToVersion$<$ TAggregateRoot $>$@{GetToVersion$<$ TAggregateRoot $>$}}
\index{GetToVersion$<$ TAggregateRoot $>$@{GetToVersion$<$ TAggregateRoot $>$}!Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$@{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$}}
\doxysubsubsection{\texorpdfstring{GetToVersion$<$ TAggregateRoot $>$()}{GetToVersion< TAggregateRoot >()}}
{\footnotesize\ttfamily T\+Aggregate\+Root \mbox{\hyperlink{classCqrs_1_1Cache_1_1CacheRepository}{Cqrs.\+Cache.\+Cache\+Repository}}$<$ T\+Authentication\+Token $>$.Get\+To\+Version$<$ T\+Aggregate\+Root $>$ (\begin{DoxyParamCaption}\item[{Guid}]{aggregate\+Id,  }\item[{int}]{version,  }\item[{I\+List$<$ \mbox{\hyperlink{interfaceCqrs_1_1Events_1_1IEvent}{I\+Event}}$<$ T\+Authentication\+Token $>$$>$}]{events = {\ttfamily null} }\end{DoxyParamCaption})}



Retrieves an I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$ of type {\itshape T\+Aggregate\+Root}  up to and including the provided {\itshape version} . 


\begin{DoxyTemplParams}{Template Parameters}
{\em T\+Aggregate\+Root} & The Type of the I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$.\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em aggregate\+Id} & The identifier of the I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$ to retrieve.\\
\hline
{\em version} & Load events up-\/to and including from this version\\
\hline
{\em events} & A collection of I\+Event$<$\+T\+Authentication\+Token$>$ to replay on the retrieved I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$. If null, the I\+Event\+Store$<$\+T\+Authentication\+Token$>$ will be used to retrieve a list of I\+Event$<$\+T\+Authentication\+Token$>$ for you. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{interfaceCqrs_1_1Domain_1_1IAggregateRepository_aa0d6b4b9b117357e1676cae829fe2a5c_aa0d6b4b9b117357e1676cae829fe2a5c}{Cqrs.\+Domain.\+I\+Aggregate\+Repository$<$ T\+Authentication\+Token $>$}}.

\begin{Desc}
\item[Type Constraints]\begin{description}
\item[{\em T\+Aggregate\+Root} : {\em I\+Aggregate\+Root$<$T\+Authentication\+Token$>$}]\end{description}
\end{Desc}
\mbox{\Hypertarget{classCqrs_1_1Cache_1_1CacheRepository_a69df7ee1dc2e4cd38431ab987655eab3_a69df7ee1dc2e4cd38431ab987655eab3}\label{classCqrs_1_1Cache_1_1CacheRepository_a69df7ee1dc2e4cd38431ab987655eab3_a69df7ee1dc2e4cd38431ab987655eab3}} 
\index{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$@{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$}!Save$<$ TAggregateRoot $>$@{Save$<$ TAggregateRoot $>$}}
\index{Save$<$ TAggregateRoot $>$@{Save$<$ TAggregateRoot $>$}!Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$@{Cqrs.Cache.CacheRepository$<$ TAuthenticationToken $>$}}
\doxysubsubsection{\texorpdfstring{Save$<$ TAggregateRoot $>$()}{Save< TAggregateRoot >()}}
{\footnotesize\ttfamily virtual void \mbox{\hyperlink{classCqrs_1_1Cache_1_1CacheRepository}{Cqrs.\+Cache.\+Cache\+Repository}}$<$ T\+Authentication\+Token $>$.Save$<$ T\+Aggregate\+Root $>$ (\begin{DoxyParamCaption}\item[{T\+Aggregate\+Root}]{aggregate,  }\item[{int?}]{expected\+Version = {\ttfamily null} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Locks the cache, adds the provided {\itshape aggregate}  to the cache if not already in it, then calls I\+Aggregate\+Repository$<$\+T\+Authentication\+Token$>$.\+Save$<$\+T\+Aggregate\+Root$>$ on Repository. In the event of an Exception the {\itshape aggregate}  is always ejected out of the \mbox{\hyperlink{namespaceCqrs_1_1Cache}{Cache}}. 


\begin{DoxyTemplParams}{Template Parameters}
{\em T\+Aggregate\+Root} & The Type of the I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$.\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em aggregate} & The I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$ to save and persist.\\
\hline
{\em expected\+Version} & The version number the I\+Aggregate\+Root$<$\+T\+Authentication\+Token$>$ is expected to be at.\\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{interfaceCqrs_1_1Domain_1_1IAggregateRepository_a306baf8aa6faabe893f93e5db5d3517d_a306baf8aa6faabe893f93e5db5d3517d}{Cqrs.\+Domain.\+I\+Aggregate\+Repository$<$ T\+Authentication\+Token $>$}}.

\begin{Desc}
\item[Type Constraints]\begin{description}
\item[{\em T\+Aggregate\+Root} : {\em I\+Aggregate\+Root$<$T\+Authentication\+Token$>$}]\end{description}
\end{Desc}
